{
  "description": "Configuración Real para tus Nodos CloudLab",
  "version": "1.0",
  "date": "2025-11-13",

  "topology": {
    "network": "10.10.1.0/24",
    "mtu": 9000,
    "interface_name": "ens1f0"
  },

  "node_controller": {
    "hostname": "node-controller",
    "management_ip": "128.110.219.172",

    "data_plane": {
      "interface": "ens1f0",
      "ip": "10.10.1.5",
      "mac": "0c:42:a1:8b:2f:c8",
      "mtu": 9000,
      "status": "UP"
    },

    "nics": [
      {
        "pci": "0000:01:00.0",
        "model": "Mellanox ConnectX-5",
        "interface": "ens1f0 (probablemente)",
        "note": "Usar este para DPDK"
      },
      {
        "pci": "0000:01:00.1",
        "model": "Mellanox ConnectX-5",
        "interface": "ens1f1",
        "note": "Puerto 2 (opcional)"
      },
      {
        "pci": "0000:41:00.0",
        "model": "Mellanox ConnectX-5 Ex",
        "note": "Alternativo"
      },
      {
        "pci": "0000:41:00.1",
        "model": "Mellanox ConnectX-5 Ex",
        "note": "Alternativo"
      }
    ],

    "dpdk_config": {
      "nic_pci": "0000:01:00.0",
      "port_id": 0,
      "num_cores": 4,
      "hugepages": 4096
    }
  },

  "node_monitor": {
    "hostname": "node-monitor",
    "management_ip": "128.110.219.171",

    "data_plane": {
      "interface": "ens1f0",
      "ip": "10.10.1.2",
      "mac": "0c:42:a1:8c:dd:0c",
      "mtu": 9000,
      "status": "UP"
    },

    "alternate_interfaces": {
      "eno34": {
        "ip": "10.10.1.3",
        "note": "Alternativa en misma red"
      }
    }
  },

  "traffic_config": {
    "comment": "Configuración para generador baseline",

    "network": {
      "src_ip_base": "192.168.0.0",
      "src_netmask": "255.255.0.0",
      "dst_ip": "10.10.1.2",
      "dst_mac": "0c:42:a1:8c:dd:0c",
      "src_mac": "0c:42:a1:8b:2f:c8",
      "dst_port": 80
    },

    "profile": "medium",
    "base_rate_pps": 50000,
    "enable_variations": true
  },

  "connectivity_test": {
    "status": "VERIFIED ✅",
    "ping_results": {
      "target": "10.10.1.2",
      "packets_sent": 3,
      "packets_received": 3,
      "packet_loss": "0%",
      "avg_rtt_ms": 0.192,
      "status": "EXCELLENT"
    }
  },

  "quick_commands": {
    "comment": "Comandos listos para copiar-pegar en node-controller",

    "setup": [
      "echo 4096 | sudo tee /proc/sys/vm/nr_hugepages",
      "sudo modprobe vfio-pci",
      "sudo dpdk-devbind.py --bind=vfio-pci 0000:01:00.0"
    ],

    "build": [
      "cd ~/dpdk_100g/http_flood_advance/benign_generator",
      "make clean",
      "make"
    ],

    "run_dpdk": [
      "sudo ./build/baseline_traffic_gen -l 0-3 -n 4 --proc-type=primary --file-prefix=baseline"
    ],

    "run_python": [
      "python3 baseline_dataset_generator.py -d 300 -p medium --dst-ip 10.10.1.2 --dst-mac 0c:42:a1:8c:dd:0c -o baseline.pcap"
    ],

    "monitor": [
      "watch -n 1 'ethtool -S ens1f0 | grep tx_packets'",
      "sudo tcpdump -i ens1f0 -c 20 -nn"
    ],

    "verify": [
      "ping -c 3 10.10.1.2",
      "ip addr show ens1f0",
      "sudo dpdk-devbind.py --status"
    ],

    "cleanup": [
      "sudo dpdk-devbind.py --bind=mlx5_core 0000:01:00.0"
    ]
  },

  "notes": [
    "Red experimental: 10.10.1.0/24",
    "MTU configurado a 9000 (jumbo frames)",
    "Conectividad verificada: ping OK (0.192ms avg)",
    "NICs Mellanox ConnectX-5 (soportan DPDK)",
    "Interface ens1f0 en ambos nodos",
    "PCI probable del Controller: 0000:01:00.0",
    "Confirmar PCI con: ethtool -i ens1f0 | grep bus"
  ]
}
